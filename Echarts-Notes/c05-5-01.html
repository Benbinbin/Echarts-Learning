<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>5.1 3D 球面轨迹图</title>
  <script src="js/echarts.js"></script>
  <script src="js/echarts-gl.min.js"></script>
  <link href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>
  <!-- 以 js 文件的方式引入底图，会自动注册地图名字和数据，以下引入了名为 china 的中国矢量地图数据 -->
  <script type="text/javascript" src="js/china.js"></script>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://benbinbin.github.io/Echarts-Learning">Echarts Learning</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item ml-lg-2"><a href="https://github.com/Benbinbin/Echarts-Learning"><svg height="100%"
                viewBox="0 0 16 16" version="1.1" width="30">
                <path fill-rule="evenodd"
                  d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                </path>
              </svg></a></li>
        </ul>
      </div>
    </nav>
  </header>

  <aside>
    <div class="top">
      <a href="#" target="_self">&lt; top</a>
    </div>
  </aside>

  <article class="container">
    <h1>
      3D 球面轨迹图
    </h1>
    <p>⚠️ 在创作 3D 可视化时，需要再加载额外的 <a href="https://echarts.apache.org/zh/download.html">GL 拓展包</a>
      <code>echarts-gl.min.js</code>。
      <hr>

      <!-- 为ECharts准备一个具备大小（宽高）的 DOM -->
    <div id="globe" style="height:800px;margin-bottom: 50px"></div>
    <!-- 引入 3D 球面轨迹图的可视化参数设置 -->
    <script src="./c05-5-01-template/set/settings.js"></script>
    <script>
      // 基于准备好的 DOM 初始化 Echarts 实例
      var globe = echarts.init(document.getElementById('globe'));
      // 数据
      let rawData = [
        [121.4040846, 31.08446175, 120.6418032, 31.3759706, 0.470945444],
        [121.4040846, 31.08446175, 120.75392, 30.65486857, 0.584698999],
        [121.4040846, 31.08446175, 120.3516295, 31.66154405, 0.096953273],
        [121.4040846, 31.08446175, 107.8643853, 30.05537369, 0.496472919],
        [121.4040846, 31.08446175, 113.9810975, 22.66121743, 0.614043082],
        [121.4040846, 31.08446175, 121.4622835, 29.71958823, 0.181327489],
        [121.4040846, 31.08446175, 119.679057, 31.69255439, 0.717188489],
        [121.4040846, 31.08446175, 119.4819855, 32.06677497, 0.64733422],
        [121.4040846, 31.08446175, 120.6288741, 29.71267236, 0.564219513],
        [121.4040846, 31.08446175, 119.9542688, 29.11645354, 0.452049126],
        [121.4040846, 31.08446175, 120.1752862, 33.51535556, 0.750435896],
        [121.4040846, 31.08446175, 119.8712273, 30.74619674, 0.661698138],
        [121.4040846, 31.08446175, 120.0575518, 32.29585238, 0.177197347],
        [121.4040846, 31.08446175, 117.4807057, 34.25877669, 0.762328707],
        [121.4040846, 31.08446175, 122.1391725, 30.0553942, 0.23478405],
        [121.4040846, 31.08446175, 119.4714098, 32.73758963, 0.454304007],
        [121.4040846, 31.08446175, 120.0101223, 27.66259934, 0.558709228],
        [121.4040846, 31.08446175, 121.0896494, 28.79200829, 0.078813845],
        [121.4040846, 31.08446175, 118.6775168, 28.93407897, 0.248300009],
        [121.4040846, 31.08446175, 118.9618449, 33.3561517, 0.417155369],
        [121.4040846, 31.08446175, 118.5180441, 33.78458183, 0.172513782],
        [121.4040846, 31.08446175, 108.7895035, 34.11078198, 0.192664818],
        [121.4040846, 31.08446175, 119.1318876, 34.53290861, 0.26526199],
        [121.4040846, 31.08446175, 119.5105276, 28.19829615, 0.325157506],
        [121.4040846, 31.08446175, 114.3380923, 30.62565422, 0.714613423],
        [121.4040846, 31.08446175, 123.1366922, 42.09365948, 0.957523752],
        [121.4040846, 31.08446175, 118.1106876, 24.68304487, 0.475027044],
        [121.4040846, 31.08446175, 117.3323945, 39.30855426, 0.6232818],
        [119.484701, 29.90497981, 120.75392, 30.65486857, 0.072322711],
        [119.484701, 29.90497981, 120.6288741, 29.71267236, 0.665572951],
        [119.484701, 29.90497981, 121.4040846, 31.08446175, 0.350923872],
        [119.484701, 29.90497981, 119.8712273, 30.74619674, 0.472296615],
        [119.484701, 29.90497981, 119.9542688, 29.11645354, 0.082681827],
        [119.484701, 29.90497981, 121.4622835, 29.71958823, 0.860157824],
        [119.484701, 29.90497981, 120.6418032, 31.3759706, 0.121218202],
        [119.484701, 29.90497981, 121.0896494, 28.79200829, 0.845791357],
        [119.484701, 29.90497981, 120.0101223, 27.66259934, 0.221411991],
        [119.484701, 29.90497981, 118.6775168, 28.93407897, 0.389682627],
        [119.484701, 29.90497981, 118.8424637, 31.9287593, 0.760096929],
        [119.484701, 29.90497981, 119.5105276, 28.19829615, 0.489790948],
        [119.484701, 29.90497981, 120.3516295, 31.66154405, 0.523665286],
        [119.484701, 29.90497981, 122.1391725, 30.0553942, 0.021596161],
        [119.484701, 29.90497981, 119.679057, 31.69255439, 0.469411386],
        [119.484701, 29.90497981, 113.9810975, 22.66121743, 0.968119473],
        [119.484701, 29.90497981, 107.8643853, 30.05537369, 0.294616455],
        [119.484701, 29.90497981, 118.5180441, 33.78458183, 0.172760099],
        [119.484701, 29.90497981, 102.8751023, 25.38529778, 0.634401283],
        [119.484701, 29.90497981, 108.7895035, 34.11078198, 0.524824711],
        [119.484701, 29.90497981, 118.0771654, 29.90608945, 0.952975764],
        [119.484701, 29.90497981, 108.4640157, 23.05841343, 0.208214267],
        [119.484701, 29.90497981, 119.4819855, 32.06677497, 0.371490194],
        [119.484701, 29.90497981, 120.9967569, 32.18937212, 0.30781406],
        [119.484701, 29.90497981, 113.4718508, 34.62636278, 0.875926827],
        [119.484701, 29.90497981, 119.1318876, 34.53290861, 0.947231426],
        [119.484701, 29.90497981, 118.9618449, 33.3561517, 0.166305701],
        [119.484701, 29.90497981, 120.1752862, 33.51535556, 0.66191161],
        [118.8424637, 31.9287593, 119.4819855, 32.06677497, 0.438144318],
        [118.8424637, 31.9287593, 121.4040846, 31.08446175, 0.070321381],
        [118.8424637, 31.9287593, 120.6418032, 31.3759706, 0.37414271],
        [118.8424637, 31.9287593, 118.0988852, 32.54498466, 0.409863089],
        [118.8424637, 31.9287593, 119.679057, 31.69255439, 0.205497054],
        [118.8424637, 31.9287593, 119.4714098, 32.73758963, 0.17795631],
        [118.8424637, 31.9287593, 120.3516295, 31.66154405, 0.051097182],
        [118.8424637, 31.9287593, 118.9618449, 33.3561517, 0.560297204],
        [118.8424637, 31.9287593, 117.4807057, 34.25877669, 0.682615577],
        [118.8424637, 31.9287593, 118.6137635, 31.53237786, 0.774678483],
        [118.8424637, 31.9287593, 120.0575518, 32.29585238, 0.756284585],
        [118.8424637, 31.9287593, 120.9967569, 32.18937212, 0.964911664],
        [118.8424637, 31.9287593, 120.1752862, 33.51535556, 0.628060198],
        [118.8424637, 31.9287593, 118.5180441, 33.78458183, 0.474086006],
        [118.8424637, 31.9287593, 119.1318876, 34.53290861, 0.68449717],
        [118.8424637, 31.9287593, 119.8712273, 30.74619674, 0.064333516],
        [118.8424637, 31.9287593, 120.75392, 30.65486857, 0.956510814],
        [118.8424637, 31.9287593, 121.4622835, 29.71958823, 0.731996658],
        [118.8424637, 31.9287593, 113.9810975, 22.66121743, 0.063063306],
        [118.8424637, 31.9287593, 107.8643853, 30.05537369, 0.966151267],
        [118.8424637, 31.9287593, 108.7895035, 34.11078198, 0.387357325],
        [118.8424637, 31.9287593, 121.0896494, 28.79200829, 0.667973051],
        [118.8424637, 31.9287593, 125.7667399, 44.37687282, 0.068312886],
        [118.8424637, 31.9287593, 118.1106876, 24.68304487, 0.542571708],
        [118.8424637, 31.9287593, 113.1529594, 28.22951311, 0.175981132],
        [118.8424637, 31.9287593, 122.1391725, 30.0553942, 0.615966639]
      ]

      // 转换数据，将每个数据项转换为一个对象，方便后期调用访问
      globeData = rawData.map(function (item) {
        return {
          coords: [[item[0], item[1]], [item[2], item[3]]],
          lineStyle: {
            width: theWidth,
            opacity: item[4] * theOpac,   // 将每项数据（数组）最后一个值 value 作为透明度大小的基准
            color: theColor
          }
        };
      });

      // 指定图表的配置项和数据
      // 地球组件需要加载的图片资源在目录 c05-5-01-template 的子目录 asset 中
      option = {
        // 地球组件
        // 组件提供了地球的绘制以及相应的坐标系，开发者可以在上面展示三维的散点图、气泡图、柱状图、飞线图。
        globe: {
          environment: './c05-5-01-template/asset/' + theBackground,   // 环境贴图
          heightTexture: './c05-5-01-template/asset/' + theHeight,   // 地球的高度纹理
          baseTexture: './c05-5-01-template/asset/' + theBase,   // 地球的纹理

          displacementScale: theHeightScale,
          displacementQuality: 'high',

          // baseColor: '#000',

          shading: 'realistic',
          realisticMaterial: {
            roughness: 0.9,
            metalness: 0
          },

          postEffect: {
            enable: true,
            depthOfField: {
              enable: false,
              focalDistance: 150
            }
          },
          temporalSuperSampling: {
            enable: true
          },
          light: {
            ambient: {
              intensity: 0
            },
            main: {
              intensity: 2,
              shadow: true
            },
            ambientCubemap: {
              texture: './c05-5-01-template/asset/globe_light2.hdr',
              exposure: 1,
              diffuseIntensity: 0.2,
              specularIntensity: 2
            }
          },
          // 用于鼠标的旋转，缩放等视角控制
          viewControl: {
            autoRotate: false,   // 开启视角绕物体的自动旋转查看
            targetCoord: [116.46, 39.92],   // 定位到北京
            distance: 80   // 默认视角距离主体的距离，对于 globe 来说是距离地球表面的距离
          },
          silent: true,
          layers: [{
            type: 'blend',
            blendTo: 'emission',
            texture: './c05-5-01-template/asset/night.jpg'
          }]
        },
        series: [{
          name: 'Global',
          type: 'lines3D',   // 三维的飞线图数据类型。跟二维的飞线图一样用于表现起点终点的线数据。更多用在地理可视化上。
          // 飞线的尾迹特效
          effect: {
            show: effectShow,
            trailWidth: theEffWidth,
            constantSpeed: theSpeed,
            trailLength: theEffLength,
            trailOpacity: theEffOpac,
            trailColor: theEffColor
          },
          // 混合模式，
          blendMode: 'lighter',   // lighter 叠加模式，可以让数据集中的区域因叠加而产生高亮的效果
          //blendMode: 'source-over'
          // polyline: true,
          data: globeData
        }]
      };

      // 使用刚指定的配置项和数据显示图表。
      globe.setOption(option);
    </script>

  </article>
</body>

</html>