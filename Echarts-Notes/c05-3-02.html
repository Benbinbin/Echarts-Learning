<!DOCTYPE html>
<html lang="zh-cmn-Hans">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>3.2 创建空间图表 - 3.3 加载在线底图</title>
  <script src="js/echarts.js"></script>
  <!--cdn from https://cdnjs.com/ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha256-aAr2Zpq8MZ+YA/D6JtRD3xtrwpEz2IqOS+pWD/7XKIw=" crossorigin="anonymous" />
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
  <!-- 以 js 文件的方式引入底图，会自动注册地图名字和数据，以下分别引入了名为 china 和 bmap 的底图-->
  <!-- 通过 CDN 从 Echarts 引入中国矢量地图.但是现在由于规定已经停止提供下载服务，建议使用各大地图应用作为地图 -->
  <script type="text/javascript" src="js/china.js"></script>
  <!-- 通过 CDN 加载 Echarts 提供的百度地图组件，需要先在百度地图开发者平台申请 ak。参考教程：https://github.com/apache/incubator-echarts/tree/master/extension/bmap -->
  <!--引入百度地图的 jssdk，这里需要使用你在百度地图开发者平台申请的 ak-->
  <!-- <script src="http://api.map.baidu.com/api?v=2.0&ak=..."></script> -->
  <!-- 引入百度地图扩展 -->
  <!-- <script type="text/javascript" src="js/bmap.min.js"></script> -->
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <a class="navbar-brand" href="https://benbinbin.github.io/Echarts-Learning">Echarts Learning</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent"
        aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item ml-lg-2"><a href="https://github.com/Benbinbin/Echarts-Learning"><svg height="100%"
                viewBox="0 0 16 16" version="1.1" width="30">
                <path fill-rule="evenodd"
                  d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
                </path>
              </svg></a></li>
        </ul>
      </div>
    </nav>
  </header>

  <aside>
    <div class="top">
      <a href="#" target="_self">&lt; top</a>
    </div>
  </aside>

  <article class="container">
    <h1>
      创建空间图表
    </h1>
    <p>⚠️ 在可视和空间数据时，需要先加载底图。ECharts 中提供了<a
        href="https://echarts.apache.org/zh/option.html#geo.map">两种格式的地图数据</a>，一种是可以直接 script 标签引入的 js
      文件，引入后会自动注册地图名字和数据。还有一种是 JSON 文件，需要通过 AJAX 异步加载后手动注册。</p>
    <p>💡 可以使用 ECharts 提供的<a href="https://github.com/apache/incubator-echarts/tree/master/extension/bmap"
        target="_blank">百度地图扩展</a>，将百度地图作为地图。还可以使用<a href="http://lbsyun.baidu.com/img-editor.html"
        target="_blank">百度地图底图编辑工具</a>定制样式。</p>
    <hr>

    <!-- 为ECharts准备一个具备大小（宽高）的 DOM -->
    <div id="geoBasic" style="height:600px"></div>
    <script>
      // 基于准备好的 DOM 初始化 Echarts 实例
      var geoBasic = echarts.init(document.getElementById('geoBasic'));
      // 数据
      var rawData = [
        ['大庆', 125.03, 46.58, 279],
        ['武汉', 114.31, 30.52, 273],
        ['合肥', 117.27, 31.86, 229],
        ['菏泽', 115.480656, 35.23375, 194],
        ['廊坊', 116.7, 39.53, 193],
        ['衢州', 118.88, 28.97, 177],
        ['长沙', 113, 28.21, 175],
        ['岳阳', 113.09, 29.37, 169],
        ['金华', 119.64, 29.12, 157],
        ['湘潭', 112.91, 27.87, 154],
        ['保定', 115.48, 38.85, 153],
        ['常德', 111.69, 29.05, 152],
        ['莱芜', 117.67, 36.19, 148],
        ['石家庄', 114.48, 38.03, 147],
        ['株洲', 113.16, 27.83, 143],
        ['秦皇岛', 119.57, 39.95, 136],
        ['洛阳', 112.44, 34.7, 134],
        ['丽水', 119.92, 28.45, 133],
        ['义乌', 120.06, 29.32, 132],
        ['宜昌', 111.3, 30.7, 130],
        ['荆州', 112.239741, 30.335165, 127],
        ['德州', 116.29, 37.45, 120],
        ['济宁', 116.59, 35.38, 120],
        ['唐山', 118.02, 39.63, 119],
        ['平顶山', 113.29, 33.75, 119],
        ['邢台', 114.48, 37.05, 119],
        ['芜湖', 118.38, 31.33, 117],
        ['聊城', 115.97, 36.45, 116],
        ['哈尔滨', 126.63, 45.75, 114],
        ['郑州', 113.65, 34.76, 113],
        ['泰安', 117.13, 36.18, 112],
        ['诸暨', 120.23, 29.71, 112],
        ['富阳', 119.95, 30.07, 106],
        ['天津', 117.2, 39.13, 105],
        ['南充', 106.110698, 30.837793, 104],
        ['临沂', 118.35, 35.05, 103],
        ['沧州', 116.83, 38.33, 100],
        ['临安', 119.72, 30.23, 99],
        ['兰州', 103.73, 36.03, 99],
        ['邯郸', 114.47, 36.6, 98],
        ['九江', 115.97, 29.71, 96],
        ['温州', 120.65, 28.01, 95],
        ['德阳', 104.37, 31.13, 93],
        ['济南', 117, 36.65, 92],
        ['安阳', 114.35, 36.1, 90],
        ['开封', 114.35, 34.79, 90],
        ['鞍山', 122.85, 41.12, 86],
        ['溧阳', 119.48, 31.43, 86],
        ['库尔勒', 86.06, 41.68, 86],
        ['淄博', 118.05, 36.78, 85],
        ['乌鲁木齐', 87.68, 43.77, 84],
        ['枣庄', 117.57, 34.86, 84],
        ['杭州', 120.19, 30.26, 84],
        ['衡水', 115.72, 37.72, 80],
        ['包头', 110, 40.58, 80],
        ['绵阳', 104.73, 31.48, 80],
        ['北京', 116.46, 39.92, 79],
        ['徐州', 117.2, 34.26, 79],
        ['焦作', 113.21, 35.24, 75],
        ['句容', 119.16, 31.95, 75],
        ['克拉玛依', 84.77, 45.59, 72],
        ['渭南', 109.5, 34.52, 72],
        ['马鞍山', 118.48, 31.56, 72],
        ['宝鸡', 107.15, 34.38, 72],
        ['贵阳', 106.71, 26.57, 71],
        ['无锡', 120.29, 31.59, 71],
        ['本溪', 123.73, 41.3, 71],
        ['滨州', 118.03, 37.36, 70],
        ['台州', 121.420757, 28.656386, 67],
        ['南京', 118.78, 32.04, 67],
        ['重庆', 106.54, 29.59, 66],
        ['潍坊', 119.1, 36.62, 65],
        ['扬州', 119.42, 32.39, 64],
        ['常州', 119.95, 31.79, 64],
        ['牡丹江', 129.58, 44.6, 63],
        ['遵义', 106.9, 27.7, 63],
        ['绍兴', 120.58, 30.01, 63],
        ['金坛', 119.56, 31.74, 62],
        ['东营', 118.49, 37.46, 62],
        ['西安', 108.95, 34.27, 61],
        ['北海', 109.12, 21.49, 60],
        ['镇江', 119.44, 32.2, 59],
        ['桂林', 110.28, 25.29, 59],
        ['张家界', 110.479191, 29.117096, 59],
        ['宜兴', 119.82, 31.36, 59],
        ['宜宾', 104.56, 29.77, 58],
        ['呼和浩特', 111.65, 40.82, 58],
        ['成都', 104.06, 30.67, 58],
        ['大同', 113.3, 40.12, 58],
        ['阳江', 111.95, 21.85, 57],
        ['泸州', 105.39, 28.91, 57],
        ['西宁', 101.74, 36.56, 57],
        ['自贡', 104.778442, 29.33903, 56],
        ['吉林', 126.57, 43.87, 56],
        ['锦州', 121.15, 41.13, 54],
        ['南昌', 115.89, 28.68, 54],
        ['柳州', 109.4, 24.33, 54],
        ['三亚', 109.511909, 18.252847, 54],
        ['三门峡', 111.19, 34.76, 53],
        ['胶州', 120.03336, 36.264622, 52],
        ['银川', 106.27, 38.47, 52],
        ['张家港', 120.555821, 31.875428, 52],
        ['嘉兴', 120.76, 30.77, 51],
        ['长春', 125.35, 43.88, 51],
        ['沈阳', 123.38, 41.8, 50],
        ['苏州', 120.62, 31.32, 50],
        ['茂名', 110.88, 21.68, 50],
        ['石嘴山', 106.39, 39.04, 49],
        ['大连', 121.62, 38.92, 47],
        ['临汾', 111.5, 36.08, 47],
        ['吴江', 120.63, 31.16, 47],
        ['肇庆', 112.44, 23.05, 46],
        ['江门', 113.06, 22.61, 45],
        ['章丘', 117.53, 36.72, 45],
        ['铜川', 109.11, 35.09, 44],
        ['平度', 119.97, 36.77, 44],
        ['佛山', 113.11, 23.05, 44],
        ['海口', 110.35, 20.02, 44],
        ['宿迁', 118.3, 33.96, 43],
        ['咸阳', 108.72, 34.36, 43],
        ['珠海', 113.52, 22.3, 42],
        ['长治', 113.08, 36.18, 41],
        ['深圳', 114.07, 22.62, 41],
        ['寿光', 118.73, 36.86, 40],
        ['盘锦', 122.070714, 41.119997, 40],
        ['太原', 112.53, 37.87, 39],
        ['清远', 113.01, 23.7, 39],
        ['中山', 113.38, 22.52, 39],
        ['昆明', 102.73, 25.04, 39],
        ['韶关', 113.62, 24.84, 38],
        ['嘉峪关', 98.289152, 39.77313, 38],
        ['广州', 113.23, 23.16, 38],
        ['延安', 109.47, 36.6, 38],
        ['南宁', 108.33, 22.84, 37],
        ['营口', 122.18, 40.65, 37],
        ['惠州', 114.4, 23.09, 37],
        ['江阴', 120.26, 31.91, 37],
        ['蓬莱', 120.75, 37.8, 37],
        ['常熟', 120.74, 31.64, 36],
        ['东莞', 113.75, 23.04, 36],
        ['河源', 114.68, 23.73, 36],
        ['淮安', 119.15, 33.5, 36],
        ['泰州', 119.9, 32.49, 36],
        ['连云港', 119.16, 34.59, 35],
        ['葫芦岛', 120.836932, 40.711052, 35],
        ['揭阳', 116.35, 23.55, 34],
        ['荣成', 122.41, 37.16, 34],
        ['昆山', 120.95, 31.39, 33],
        ['宁波', 121.56, 29.86, 33],
        ['湛江', 110.359377, 21.270708, 33],
        ['莱州', 119.942327, 37.177017, 32],
        ['湖州', 120.1, 30.86, 32],
        ['汕头', 116.69, 23.39, 32],
        ['抚顺', 123.97, 41.97, 31],
        ['玉溪', 102.52, 24.35, 31],
        ['张家口', 114.87, 40.82, 31],
        ['阳泉', 113.57, 37.85, 31],
        ['瓦房店', 121.979603, 39.627114, 30],
        ['即墨', 120.45, 36.38, 30],
        ['福州', 119.3, 26.08, 29],
        ['烟台', 121.39, 37.52, 28],
        ['丹东', 124.37, 40.13, 27],
        ['太仓', 121.1, 31.45, 27],
        ['曲靖', 103.79, 25.51, 27],
        ['厦门', 118.1, 24.46, 26],
        ['汕尾', 115.375279, 22.786211, 26],
        ['潮州', 116.63, 23.68, 26],
        ['梅州', 116.1, 24.55, 25],
        ['文登', 122.05, 37.2, 25],
        ['上海', 121.48, 31.22, 25],
        ['攀枝花', 101.718637, 26.582347, 25],
        ['威海', 122.1, 37.5, 25],
        ['承德', 117.93, 40.97, 25],
        ['拉萨', 91.11, 29.97, 24],
        ['云浮', 112.02, 22.93, 24],
        ['南通', 121.05, 32.08, 23],
        ['胶南', 119.97, 35.88, 22],
        ['泉州', 118.58, 24.93, 21],
        ['莱西', 120.53, 36.86, 21],
        ['日照', 119.46, 35.42, 21],
        ['金昌', 102.188043, 38.520089, 19],
        ['青岛', 120.33, 36.07, 18],
        ['乳山', 121.52, 36.89, 18],
        ['赤峰', 118.87, 42.28, 16],
        ['盐城', 120.13, 33.38, 15],
        ['齐齐哈尔', 123.97, 47.33, 14],
        ['鄂尔多斯', 109.781327, 39.608266, 12],
        ['招远', 120.38, 37.35, 12],
        ['舟山', 122.207216, 29.985295, 12],
        ['海门', 121.15, 31.89, 9]
      ];

      // 转换数据
      // 将二维数组中每一个元素转换为一个对象
      function convertData(d) {
        var res = [];
        for (var i = 0; i < d.length; i++) {
          res.push({
            name: d[i][0],
            value: [d[i][1], d[i][2], d[i][3]]
          });
        }
        return res;
      }

      var data = convertData(rawData);

      // options 放置需要切换的数据
      option = {
        title: {
          text: '地理 POI 点数据可视化',
          left: 'center'
        },
        legend: {
          data: ['pm2.5', 'Top 5'],
          top: '10%',
          left: 'center'
        },
        tooltip: {
          trigger: 'item'
        },
        // 视觉映射组件，一般配合 HeatMap 使用
        visualMap: {
          type: 'continuous',
          min: 0,
          max: 100,
          left: 'left',
          top: 'bottom',
          text: ['高', '低'],
          calculable: true   // 是否显示拖拽用的手柄（手柄能拖拽调整选中范围）
        },
        // 地理坐标系组件，Echarts 中内置的地图矢量图片
        // 一般用于地图的绘制，支持在地理坐标系上绘制散点图、线集
        geo: {
          map: 'china',   // 使用中国作为地图，需要在 header 中引入相应的脚本
          label: {
            emphasis: {
              show: false   // 是否开启悬停高亮显示（地名）
            }
          },
          zoom: 5,   // 初始化时视角的缩放比例
          center: [116.46, 39.92],   // 初始化时视角的中心点
          // 是否开启鼠标缩放和平移漫游，默认不开启，设置成 true 为都开启
          // 如果只想要开启地图的缩放或者平移，可以设置成 'scale' 或者 'move'
          roam: true,
          itemStyle: {
            normal: {
              areaColor: 'lightgray',
              borderColor: 'dimgray'
            },
            emphasis: {
              areaColor: 'white'
            }
          }
        },
        // 如果地理坐标系组件替换为百度地图组件 bmap，但需要在百度地图开发者平台申请 ak
        // 配置类似于 geo
        // bmap: {
        //   center: [104.114129, 37.550339],
        //   zoom: 5,
        //   roam: true,
        //   mapStyle: {
        // 可以使用百度地图底图编辑工具定制样式
        // 只要将生成的 JSON 文件替换该属性即可
        //     styleJson: [
        //       {
        //         "featureType": "all",
        //         "elementType": "all",
        //         "stylers": {
        //           "lightness": 10,
        //           "saturation": -100
        //         }
        //       }
        //     ]
        //   }
        // },
        series: [
          {
            name: 'pm2.5',
            type: 'scatter',
            coordinateSystem: 'geo',   // 将散点图使用的坐标系设置为地理坐标系组件，如果使用百度地图则设置为 'bmap'
            data: data.slice(5,),   // 除了前 5 条数据外，剩余的数据绘制普通的散点
            // 散点大小基于数据的第三个值
            symbolSize: function (val) {
              return val[2] / 5;
            },
            label: {
              normal: {
                formatter: '{b}',
                position: 'right',
                show: false
              },
              emphasis: {
                show: true
              }
            },
            itemStyle: {
              normal: {
                color: 'white',
                shadowBlur: 10,
                shadowColor: '#333'
              }
            },
          },
          {
            name: 'Top 5',
            type: 'effectScatter',
            coordinateSystem: 'geo',
            data: data.slice(0, 5),   // 将前 5 条数据绘制涟漪特效动画的散点
            symbolSize: function (val) {
              return val[2] / 8;
            },
            showEffectOn: 'render',
            rippleEffect: {
              brushType: 'stroke'
            },
            hoverAnimation: true,
            label: {
              normal: {
                formatter: '{b}',
                position: 'right',
                show: true
              }
            },
            itemStyle: {
              normal: {
                color: 'brown',
                shadowBlur: 10,
                shadowColor: '#333'
              }
            }
          }
        ]
      };

      // 使用刚指定的配置项和数据显示图表。
      geoBasic.setOption(option);
    </script>

  </article>
</body>

</html>